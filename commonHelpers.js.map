{"version":3,"file":"commonHelpers.js","sources":["../src/toast.js","../src/api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport function showMessage(\n  message,\n  color,\n  position = 'topRight',\n  timeout = 5000\n) {\n  iziToast.show({\n    message,\n    color,\n    position,\n    timeout,\n  });\n}\n\nexport function showError(message) {\n  showMessage(message, 'red');\n}\n\nexport function showInfo(message) {\n  showMessage(message, 'green');\n}\n","import axios from 'axios';\nimport { showError } from './toast.js';\n\nconst BASE_API_URL = 'https://pixabay.com/api';\nconst API_KEY = '41941972-0a3072545573ea3ac4c45ea8e';\n\nexport function searchImages(query, page = 1, limit = 40) {\n  return axios\n    .get(\n      `${BASE_API_URL}/?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&per_page=${limit}&page=${page}`\n    )\n    .catch(error => {\n      showError(error.message);\n\n      return {\n        totalHits: 0,\n        hits: [],\n      };\n    })\n    .then(response => {\n      const hits = response.data.hits.map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        })\n      );\n\n      return {\n        hits,\n        total: response.data.totalHits,\n      };\n    });\n}\n","import { searchImages } from './api.js';\nimport debounce from 'lodash.debounce';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { showError, showInfo } from './toast.js';\n\nconst IMAGES_PER_PAGE = 40;\nlet lightBox;\n\nfunction bindFormEvents() {\n  const form = document.getElementById('search-form');\n\n  if (!form) {\n    return;\n  }\n\n  form.addEventListener('submit', async event => {\n    event.preventDefault();\n\n    const searchQueryElement = [...form.elements].find(\n      element => element.name === 'searchQuery'\n    );\n\n    if (!searchQueryElement) {\n      return;\n    }\n\n    const searchQuery = searchQueryElement.value;\n\n    try {\n      const images = await searchImages(searchQuery, 1, IMAGES_PER_PAGE);\n\n      storeFormData({ query: searchQuery, page: 1, total: images.total });\n      renderCards(images.hits, true);\n\n      if (!images.total) {\n        showError(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n        return;\n      }\n\n      showInfo(`Hooray! We found ${images.total} images.`);\n    } catch (e) {\n      // showError('Sorry, unexpected error happened. Please try again.');\n    }\n  });\n}\n\nfunction storeFormData({ query, page, total }) {\n  localStorage.setItem('query', query);\n  localStorage.setItem('page', page);\n  localStorage.setItem('total', total);\n}\n\nfunction getFormData() {\n  const query = localStorage.getItem('query');\n  const page = +localStorage.getItem('page');\n  const total = +localStorage.getItem('total');\n\n  return {\n    query,\n    page,\n    total,\n  };\n}\n\nfunction bindScrollEvents() {\n  window.addEventListener(\n    'scroll',\n    debounce(async () => {\n      const { scrollTop, scrollHeight, clientHeight } =\n        document.documentElement;\n\n      if (scrollTop + clientHeight >= scrollHeight && hasMoreImages()) {\n        showLoader();\n\n        const { query, page } = getFormData();\n        const images = await searchImages(query, page + 1, IMAGES_PER_PAGE);\n\n        showLoader(false);\n\n        storeFormData({ query, page: page + 1, total: images.total });\n        renderCards(images.hits, false);\n      }\n    }, 400),\n    {\n      passive: true,\n    }\n  );\n}\n\nfunction hasMoreImages() {\n  const { page, total } = getFormData();\n\n  return total > page * IMAGES_PER_PAGE;\n}\n\nfunction bindEvents() {\n  bindFormEvents();\n  bindScrollEvents();\n  lightBox = createLightBox();\n}\n\nfunction createCard(item) {\n  const {\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = item;\n  return `\n  <div class=\"photo-card\">\n    <div class=\"image-container\">\n      <a href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n      </a>\n    </div>\n    <div class=\"info\">\n        <p class=\"info-item\">\n          <b>Likes</b>\n          <span>${likes}</span>\n        </p>\n        <p class=\"info-item\">\n          <b>Views</b>\n          <span>${views}</span>\n        </p>\n        <p class=\"info-item\">\n            <b>Comments</b>\n            <span>${comments}</span>\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads</b>\n            <span>${downloads}</span>\n        </p>\n    </div>\n   </div>\n  `;\n}\n\nfunction renderCards(items, replace = true) {\n  const galleryElement = document.querySelector('.gallery');\n\n  if (!galleryElement) {\n    return;\n  }\n\n  const cardsHtml = items.map(item => createCard(item)).join('');\n\n  if (replace) {\n    galleryElement.innerHTML = cardsHtml;\n  } else {\n    galleryElement.insertAdjacentHTML('beforeend', cardsHtml);\n  }\n\n  lightBox?.refresh();\n}\n\nfunction showLoader(visible = true) {\n  const loader = document.querySelector('.loader');\n\n  if (!loader) {\n    return;\n  }\n\n  if (visible) {\n    loader.classList.remove('hidden');\n  } else {\n    loader.classList.add('hidden');\n  }\n}\n\nfunction createLightBox() {\n  return new SimpleLightbox('.gallery a', {\n    captionDelay: 250,\n    captionsData: 'alt',\n  });\n}\n\nbindEvents();\n"],"names":["showMessage","message","color","position","timeout","iziToast","showError","showInfo","BASE_API_URL","API_KEY","searchImages","query","page","limit","axios","error","response","webformatURL","largeImageURL","tags","likes","views","comments","downloads","IMAGES_PER_PAGE","lightBox","bindFormEvents","form","event","searchQueryElement","element","searchQuery","images","storeFormData","renderCards","total","getFormData","bindScrollEvents","debounce","scrollTop","scrollHeight","clientHeight","hasMoreImages","showLoader","bindEvents","createLightBox","createCard","item","items","replace","galleryElement","cardsHtml","visible","loader","SimpleLightbox"],"mappings":"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"}